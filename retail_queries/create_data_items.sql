use retaildb_timeseries_dev
go

DECLARE @temp table(row_number int identity(2888, 1), name varchar(100), caption varchar(100), value varchar(100))

insert into @temp (name, caption, value)

SELECT 'AREA_ID', 'AREA_ID', '1_1' UNION ALL
SELECT 'AREA_DESC', 'AREA_DESC', '10 miles' UNION ALL
SELECT 'DEMOG_ID', 'DEMOG_ID', '0' UNION ALL
SELECT 'STORE_ID', 'STORE_ID', '1' UNION ALL
SELECT 'RING', 'RING', '1' UNION ALL
SELECT 'STORE_NAME', 'STORE_NAME', '' UNION ALL
SELECT 'STORE_ADDR', 'STORE_ADDR', '1' UNION ALL
SELECT 'AREA_DESC2', 'AREA_DESC2', 'Ring: 10 mile radius' UNION ALL
SELECT 'STORE_LAT', 'STORE_LAT', '40.730073' UNION ALL
SELECT 'STORE_LONG', 'STORE_LONG', '-73.99277' UNION ALL
SELECT 'SITE_NAME', 'SITE_NAME', '' UNION ALL
SELECT 'TOTPOP_CY', 'TOTPOP_CY', '7231497' UNION ALL
SELECT 'POP0_CY', 'POP0_CY', '457245' UNION ALL
SELECT 'POP5_CY', 'POP5_CY', '406724' UNION ALL
SELECT 'POP10_CY', 'POP10_CY', '397117' UNION ALL
SELECT 'POP15_CY', 'POP15_CY', '452986' UNION ALL
SELECT 'POP20_CY', 'POP20_CY', '581261' UNION ALL
SELECT 'POP85_CY', 'POP85_CY', '114226' UNION ALL
SELECT 'MEDAGE_CY', 'MEDAGE_CY', '34.9' UNION ALL
SELECT 'WHITE_CY', 'WHITE_CY', '3329236' UNION ALL
SELECT 'BLACK_CY', 'BLACK_CY', '1604530' UNION ALL
SELECT 'AMERIND_CY', 'AMERIND_CY', '49778' UNION ALL
SELECT 'ASIAN_CY', 'ASIAN_CY', '971466' UNION ALL
SELECT 'PACIFIC_CY', 'PACIFIC_CY', '4423' UNION ALL
SELECT 'OTHRACE_CY', 'OTHRACE_CY', '977575' UNION ALL
SELECT 'RACE2UP_CY', 'RACE2UP_CY', '294488' UNION ALL
SELECT 'TOTHH_CY', 'TOTHH_CY', '2798907' UNION ALL
SELECT 'HINC0_CY', 'HINC0_CY', '546976' UNION ALL
SELECT 'HINC15_CY', 'HINC15_CY', '316067' UNION ALL
SELECT 'HINC25_CY', 'HINC25_CY', '279223' UNION ALL
SELECT 'HINC35_CY', 'HINC35_CY', '352219' UNION ALL
SELECT 'HINC50_CY', 'HINC50_CY', '431496' UNION ALL
SELECT 'HINC75_CY', 'HINC75_CY', '279747' UNION ALL
SELECT 'HINC100_CY', 'HINC100_CY', '297439' UNION ALL
SELECT 'HINC150_CY', 'HINC150_CY', '121503' UNION ALL
SELECT 'HINC200_CY', 'HINC200_CY', '174180' UNION ALL
SELECT 'MEDHINC_CY', 'MEDHINC_CY', '45018' UNION ALL
SELECT 'AVGHINC_CY', 'AVGHINC_CY', '70309' UNION ALL
SELECT 'PCI_CY', 'PCI_CY', '27899' UNION ALL
SELECT 'X1002_X', 'X1002_X', '13617448832' UNION ALL
SELECT 'X8029_X', 'X8029_X', '252501676' UNION ALL
SELECT 'X8031_X', 'X8031_X', '143997487' UNION ALL
SELECT 'X8035_X', 'X8035_X', '102870011' UNION ALL
SELECT 'X4029_X', 'X4029_X', '508003264' UNION ALL
SELECT 'X4032_X', 'X4032_X', '832837171' UNION ALL
SELECT 'X10003_X', 'X10003_X', '203879509' UNION ALL
SELECT 'X10006_X', 'X10006_X', '98944036' UNION ALL
SELECT 'X10007_X', 'X10007_X', '52529567' UNION ALL
SELECT 'X10008_X', 'X10008_X', '555741118' UNION ALL
SELECT 'X10009_X', 'X10009_X', '112469783' UNION ALL
SELECT 'POP2534_CY', 'POP2534_CY', '1328977' UNION ALL
SELECT 'POP3544_CY', 'POP3544_CY', '1040892' UNION ALL
SELECT 'POP4554_CY', 'POP4554_CY', '950890' UNION ALL
SELECT 'POP5564_CY', 'POP5564_CY', '769798' UNION ALL
SELECT 'POP6574_CY', 'POP6574_CY', '462517' UNION ALL
SELECT 'POP7584_CY', 'POP7584_CY', '268863' UNION ALL
SELECT 'HISPPOPCY', 'HISPPOPCY', '2237727' UNION ALL
SELECT 'HINC_50KPLUS_CY', 'HINC_50KPLUS_CY', '1304366' UNION ALL
SELECT 'HINC_75KPLUS_CY', 'HINC_75KPLUS_CY', '872870' UNION ALL
SELECT 'HINC_100KPLUS', 'HINC_100KPLUS', '593123' UNION ALL
SELECT 'POP_25PLUS_CY', 'POP_25PLUS_CY', '4936163' UNION ALL
SELECT 'POP_30PLUS_CY', 'POP_30PLUS_CY', '4238864' UNION ALL
SELECT 'AGG_INCOME', 'AGG_INCOME', '201751533320' UNION ALL
SELECT 'FEMALE_18TO34', 'FEMALE_18TO34', '1200641' UNION ALL
SELECT 'HINC_35TO100K', 'HINC_35TO100K', '1063463' UNION ALL
SELECT 'PROX_MSGROCERY', 'PROX_MSGROCERY', '16481222455'



select 
	t.row_number,
	t.name, 
	t.caption, 
	LTRIM(rtrim(t.value)),
	case 
		WHEN ISNUMERIC(LTRIM(rtrim(t.value))) = 1 then 'number'
		ELSE 'string'
	end as 'type',
	'select ' + CAST(row_number as varchar(4)) + ' as data_item_id, ''' + t.name + ''' as name, ''' + t.caption + ''' as description, ''' + 
		case 
			WHEN ISNUMERIC(LTRIM(rtrim(t.value))) = 1 then 'number'
			ELSE 'string'
		end + ''' as type,' + ' ''USA_ESRI_2011'' as source union all'
from @temp t
left join data_items di on di.name = t.name
where di.data_item_id is null